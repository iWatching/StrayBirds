---
layout: post
title: 视频系列 05：短视频拍摄(02)
category: 视频
comments: false
---

#### 需求场景
---

* 录制视频场景
	 * 个人主页视频集视频(10s,60s)
	 * 人脸识别、录制3秒视频发送至后台存档(3s)
	 * 动态发布短视频(30s)

	 
#### 短视频APP
---

* 快手
* 美拍
* VUE
* 小影
* 火山小视频
* 抖音
* 320*480 陌陌
* 540*960 租我吧
* ijkplayer

#### 解决方案
---

* 1. 七牛SDK
* 2. 美摄SDK<https://www.meishesdk.com/doc_ch/html/content/index.html>
* 3. 趣拍SDK
	* <https://www.aliyun.com/solution/media/videosdk?spm=5176.8009263.386557.642.kunbyV>
* 4. 云帆加速(不考虑)
* 5. 又拍云(不考虑)
* 6. 秒拍  <https://www.vitamio.org>(不考虑)
* 7. 综合其他短视频SDK功能对比(价格，功能稳定性，技术支持程度)
	* 7.1 采用直接买断使用特定部分功能(不推荐使用云服务方案)
	* 7.2 七牛客服支持比较及时；低端机支持不理想；
	* 7.3 趣拍功能特性更多但也有性能问题，录制10s视频，用coolpad手机录制也有抖动感
* 8. 结论
	* 8.1 七牛短视频(收费)
		* 链接1：<https://developer.qiniu.com/pili/sdk/3734/short-video-android-sdk?ref=www.qiniu.com>
		* 链接2：<https://github.com/pili-engineering/PLDroidShortVideo>
		* 主要功能：SDK主要分为3大块：拍摄、编辑、上传

	
#### 常见问题
---

* 项目存在问题
	* 即刻约：软件全屏录制，预览宽高比等于手机屏幕分辨率宽高比(绝大多数)，结合手机多样分辨率事实，所以在"16:9,4:3"以外的少数宽高比例手机上播放视频是变形的（产品问题）
	* 即刻约：点按录制视频按钮逻辑有问题，有片段处于待删除状态时，进度条展示没在录制中，但实际是在录制状态
	* 即刻约：当处于录制视频页面录制完一段时间后，按Home键退出，然后返回到录制页面，摄像头又从后置变为了前置摄像头
	* 即刻约：即刻约正在录音，美丽约暂时不能录音？
	* 即刻约：录制60s视频，上传成功花费了90s时间，测试设备M1 metal,正常网络环境
	* 即刻约：录制视频过程中，不能手势放大局部区域
	* 即刻约：为什么设置的720 * 1280的分辨率，但是录制生成的视频大小为：540 * 960
	* 即刻约：即刻约Nexus 5x录制视频过程中，会报错；
	* 美丽约：个人主页，录制普通短视频，上传成功后，video文件夹下,还存在上传成功后的短视频,合理情况下应该删除掉
	* 美丽约: 录制视频，Nexus 5x录制画面正常，生成的最终视频角度不正确(倒立)

* SDK存在问题
	* 秒拍：长期未维护；集成有权限适配问题；处理视频效率慢；确认一下秒拍最新 SDK版本(3.1版本,最后更新：2015.10.25)
	* 美摄：该SDK相对使用起来比较难懂，目前频率是一周一更新，稳定性待进一步完善
	* 七牛：我现在录制上传一个视频设置的参数如下：预览尺寸：720P;预览比例：16:9;编码尺寸：1280*720，编码码率：800kbps，提示上传成功地址打开错误：<http://114.80.216.199/xdispatch/shortvideo.pdex-service.com/record.mp4>
	* 七牛：录制时设置的编码尺寸就是最终生成的视频分辨率
	* 七牛：刚刚录制完成的视频，马上进行片段选择裁切，类似你们选择视频剪辑功能，在录制完成后，就是可编辑的.mp4文件直接进行剪辑
	* 七牛：录制过程中不支持手势放大局部区域进行拍摄
	* 七牛：录制预览页面,SurfaceView显示的宽高比你们是如何考虑的？是否一句设置的预览宽高比来设置SurefaceView的宽高？
	* 七牛：不同分辨率大小的手机，如果场景都是全屏播放视频，你们是如何做适配的？
	* 七牛：针对Android手机录制的视频，ios端播放视频，有没有需要特别注意的关键点？
	* 七牛：Demo里面，能否设置录制最大录制时长
	* 七牛：Demo里我没有找到PLSVideoConfiguration
	* 七牛：下载我自己录制的视频，看下一定时长视频有多大(M)


* 常见问题
	
	* 常规录制视频，实时美颜，滤镜一般都是最终生成视频后在处理?
	* 录制视频，我们设置的常用码率为800？其他SDK建议码率？
	* 全屏录制不同时长的短视频，那其实就限制了摄像头预览宽高比就应该跟屏幕宽高比一致，是否每台手机Camera的所支持的预览尺寸里面，就有屏幕分辨率同样的一组值或者说至少有一组宽高比一致的一组值？
	* 录制视频截图展示，并且选封面的逻辑自己实现复杂性?是否我们设置封面图用的都是关键帧图片
	
	
--- 

* 功能一览表
	
SDK         |   即刻约  |   趣拍  |   美摄   |  七牛云  |   秒拍   |
---         |   ---    |    --- |  ---     |  ---   |   ---    |
断点录制     |   Y      |    Y   |   Y      |   Y     |     Y   |
回删        |    Y     |    Y    |   Y     |   Y     |     Y   | 
点击长按拍摄  |    Y     |    Y   |   Y     |    Y     |    Y    |
选择封面     |    Y     |         |         |    Y    |         |
关键帧预览   |    Y     |         |         |    Y    |         |
实时美颜     |         |    Y    |   Y     |    Y    |     N   |
导入编辑     |         |    Y    |         |    Y    |         | 
人脸/贴纸    |         |     Y   |    Y    |         |    N    | 
摄像头切换   |   Y     |   Y     |    Y    |         |    Y    | 
分辨率调整   |         |   Y     |    Y    |         |         | 
实时水印     |        |    Y    |   Y     |         |         | 
摄像头缩放   |        |    Y    |         |    N     |        | 
实时滤镜    |        |    Y     |   Y     |         |    Y    |
实时变速    |        |    Y     |         |         |         | 
实时混音    |        |    Y     |         |         |         | 
气泡字幕    |        |    Y     |         |         |         | 
 MV效果    |        |    Y     |         |         |         |
多视频拼接  |        |    Y     |         |         |         |
静音功能    |        |          |         |    Y    |         |
剪辑指定区间 |       |          |         |    Y    |         |
倍数拍摄    |        |          |         |    Y    |         |

---

* 录制视频相关参数指标

SDK                 |    10s/M  |   30s/M  |    60s/M  |            | 
---                 |    ---    |    ---   |   ---     |   ---      | 
美摄(M1 Metal)       |          |          |            |            |  
即刻约(Meitu MP1512) |   2.9    |    8.5   |    16.9    |            |           
即刻约(Meitu MP1602) |    3     |     8.6  |    17.2    |  540 * 960 |
即刻约(coolpad Y803) |  3.9     |     9.6  |    20.5    |  360 * 592 |
即刻约(huawei_STF )  |  3.6     |    10.4  |    20.5    |            |
即刻约(m1_metal )    |  3.8     |    10.5  |    21.3    |            |
------即刻约------   |<mark>3.5M|<mark>9.5M|<mark> 19.3M|            | 
趣拍(Meitu MP1512)  |          |           |            |            |           
趣拍(Meitu MP1602)  |   4.6    |    13.5   |    27.1   |  528 * 928  |
趣拍(coolpad Y803)  |   4.2    |    11.3   |    23     |  528 * 864  |
趣拍(huawei_STF )   |          |           |           |             |
趣拍(m1_metal )     |   4.8    |    13.9   |    27.1   |             |
------趣  拍------  |<mark>4.5M|<mark>12.9M|<mark>25.7M|             | 
七牛(Meitu MP1512)  |          |           |            |            |           
七牛(Meitu MP1602)  |     1    |   3.1     |     6.7    |  720 * 960 |
七牛(coolpad Y803)  |    1.5   |   4.2     |     8.4    |  360 * 640 |
七牛(huawei_STF )   |          |           |            |            |
七牛(m1_metal )     |    1.3   |   3.8     |     7.6    |  720 * 960 |
------七  牛------  |<mark>1.3M|<mark>3.6M |<mark>7.6M  |            | 

    
#### 参考文献
---
	
* 01. <http://www.jianshu.com/p/614b3e6e641a>
* 02. <https://github.com/CJT2325/CameraView>
* 03. <http://www.jcodecraeer.com/a/opensource/2017/0523/7966.html>
* 04. <http://www.jcodecraeer.com/a/opensource/2017/0327/7733.html> 前后置摄像头


      

